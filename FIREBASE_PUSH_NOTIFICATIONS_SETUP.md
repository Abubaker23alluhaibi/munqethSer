# ๐ ุฅุนุฏุงุฏ Firebase Push Notifications

## ุงููุดููุฉ ุงูุญุงููุฉ

ุงูุฅุดุนุงุฑุงุช ูุง ุชุธูุฑ ูุฃู:
1. **FCM tokens ุบูุฑ ูุญููุธุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช** - ุงูุชุทุจูู ูุญุตู ุนูู FCM token ููู ูุง ูุฑุณูู ุฅูู ุงูุณูุฑูุฑ
2. **Firebase credentials ุบูุฑ ููุฌูุฏุฉ** - ุงูุณูุฑูุฑ ูุญุชุงุฌ ุฅูู ุฅุนุฏุงุฏุงุช Firebase ูุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช

## โ ุงูุญููู ุงููุทุจูุฉ

### 1. ุฅุฑุณุงู FCM Token ุชููุงุฆูุงู ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู

ุชู ุฅุถุงูุฉ ููุฏ ูู `auth_provider.dart` ูุฅุฑุณุงู FCM token ุชููุงุฆูุงู ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู:

```dart
// ูู loginAsUser ู loginAsDriver
_sendFcmTokenToServer(userId: user.id, phone: phone);
_sendFcmTokenToServer(driverId: driver.driverId);
```

### 2. ุชุญุณูู Logging

ุชู ุชุญุณูู ุฑุณุงุฆู ุงูุฎุทุฃ ูู `notificationService.js` ููุนุฑูุฉ ุณุจุจ ูุดู ุงูุฅุดุนุงุฑุงุช:
- โ ุฑุณุงุฆู ูุงุถุญุฉ ุนูุฏ ุนุฏู ูุฌูุฏ FCM token
- โ ุฑุณุงุฆู ูุงุถุญุฉ ุนูุฏ ุนุฏู ุชููุฆุฉ Firebase
- โ ูุนุงูุฌุฉ ุฃุฎุทุงุก Firebase ุงููุญุฏุฏุฉ

## ๐ ุฎุทูุงุช ุงูุฅุนุฏุงุฏ

### 1. ุฅุนุฏุงุฏ Firebase Project

1. ุงุฐูุจ ุฅูู [Firebase Console](https://console.firebase.google.com)
2. ุฃูุดุฆ ูุดุฑูุน ุฌุฏูุฏ ุฃู ุงุณุชุฎุฏู ูุดุฑูุน ููุฌูุฏ
3. ุฃุถู ุชุทุจูู Android/iOS ุญุณุจ ุงูุญุงุฌุฉ

### 2. ุงูุญุตูู ุนูู Firebase Admin SDK Credentials

1. ูู Firebase Console โ Project Settings โ Service Accounts
2. ุงุถุบุท "Generate New Private Key"
3. ุงุญูุธ ุงูููู JSON

### 3. ุฅุถุงูุฉ Environment Variables ูู Railway

ูู Railway Dashboard โ Variablesุ ุฃุถู:

```env
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
FIREBASE_CLIENT_EMAIL=firebase-adminsdk-xxxxx@your-project.iam.gserviceaccount.com
```

**ููู:**
- `FIREBASE_PRIVATE_KEY` ูุฌุจ ุฃู ูููู ุจูู ุนูุงูุงุช ุงูุชุจุงุณ
- ูุฌุจ ุฃู ูุญุชูู ุนูู `\n` ูู ููุงูุฉ ูู ุณุทุฑ (ุฃู ุงุณุชุฎุฏู ุณุทุฑ ูุงุญุฏ)
- ููููู ูุณุฎ ุงููููุฉ ูู ููู JSON ุงูุฐู ุญุตูุช ุนููู

### 4. ุงูุชุญูู ูู ุงูุฅุนุฏุงุฏุงุช

ุจุนุฏ ุฅุถุงูุฉ ุงููุชุบูุฑุงุชุ ุชุญูู ูู Logs ูู Railway:

```
โ Firebase Admin initialized
```

ุฅุฐุง ุฑุฃูุช:
```
โ๏ธ Firebase Admin not initialized (credentials not provided - optional)
```

ููุฐุง ูุนูู ุฃู ุงููุชุบูุฑุงุช ุบูุฑ ููุฌูุฏุฉ ุฃู ุบูุฑ ุตุญูุญุฉ.

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: "Firebase not initialized"

**ุงูุญู:**
1. ุชุญูู ูู ุฃู ุฌููุน ุงููุชุบูุฑุงุช ููุฌูุฏุฉ ูู Railway
2. ุชุญูู ูู ุฃู `FIREBASE_PRIVATE_KEY` ูุญุชูู ุนูู `\n` ูู ููุงูุฉ ูู ุณุทุฑ
3. ุชุญูู ูู ุฃู `FIREBASE_CLIENT_EMAIL` ุตุญูุญ

### ุงููุดููุฉ: "No FCM token provided"

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุฃู ุงูุชุทุจูู ูุญุตู ุนูู FCM token (ุชุญูู ูู Logs ูู ุงูุชุทุจูู)
2. ุชุฃูุฏ ูู ุฃู FCM token ูุชู ุฅุฑุณุงูู ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู
3. ุชุฃูุฏ ูู ุฃู Firebase ุชู ุชููุฆุชู ูู ุงูุชุทุจูู

### ุงููุดููุฉ: "Invalid registration token"

**ุงูุญู:**
- FCM token ููุชูู ุงูุตูุงุญูุฉ - ุงููุณุชุฎุฏู ูุญุชุงุฌ ุฅูู ุชุณุฌูู ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู

### ุงููุดููุฉ: ุงูุฅุดุนุงุฑุงุช ูุง ุชุธูุฑ ูู ุงูุชุทุจูู

**ุงูุญู:**
1. ุชุญูู ูู ุตูุงุญูุงุช ุงูุฅุดุนุงุฑุงุช ูู ุงูุชุทุจูู
2. ุชุญูู ูู ุฃู `google-services.json` ููุฌูุฏ ูู `android/app/`
3. ุชุญูู ูู ุฃู `GoogleService-Info.plist` ููุฌูุฏ ูู `ios/Runner/`
4. ุชุญูู ูู Logs ูู ุงูุชุทุจูู ููุนุฑูุฉ ุฅุฐุง ูุงูุช ุงูุฅุดุนุงุฑุงุช ุชุตู

## ๐ฑ ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช

### 1. ุงุฎุชุจุงุฑ ูู ุงูุณูุฑูุฑ

ููููู ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฌุฑูุจู ูู ุงูุณูุฑูุฑ:

```javascript
const { sendNotification } = require('./utils/notificationService');

// ุงุญุตู ุนูู FCM token ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
const user = await User.findOne({ phone: 'phone_number' });
if (user && user.fcmToken) {
  await sendNotification(
    user.fcmToken,
    'ุงุฎุชุจุงุฑ',
    'ูุฐุง ุฅุดุนุงุฑ ุชุฌุฑูุจู',
    { type: 'test' }
  );
}
```

### 2. ุงุฎุชุจุงุฑ ูู Firebase Console

1. ุงุฐูุจ ุฅูู Firebase Console โ Cloud Messaging
2. ุงุถุบุท "Send test message"
3. ุฃุฏุฎู FCM token
4. ุฃุฑุณู ุงูุฅุดุนุงุฑ

## ๐ ููุงุญุธุงุช ูููุฉ

1. **FCM Tokens ุชุชุบูุฑ** - ูุฌุจ ุชุญุฏูุซูุง ุนูุฏ:
   - ุฅุนุงุฏุฉ ุชุซุจูุช ุงูุชุทุจูู
   - ุชุญุฏูุซ ุงูุชุทุจูู
   - ุชุณุฌูู ุงูุฏุฎูู ุนูู ุฌูุงุฒ ุฌุฏูุฏ

2. **ุงูุตูุงุญูุงุช** - ุชุฃูุฏ ูู ุฃู ุงูุชุทุจูู ูุทูุจ ุตูุงุญูุงุช ุงูุฅุดุนุงุฑุงุช:
   - Android: ุชููุงุฆูุงู
   - iOS: ูุญุชุงุฌ ุฅูู ุทูุจ ุตุฑูุญ

3. **Background Notifications** - ููุชุทุจูู ุงูููุชูุญ ูู ุงูุฎูููุฉ:
   - ุชุฃูุฏ ูู ุฅุนุฏุงุฏ `firebaseMessagingBackgroundHandler` ูู `main.dart`

## โ ูุงุฆูุฉ ุงูุชุญูู

- [ ] Firebase Project ุชู ุฅูุดุงุคู
- [ ] Firebase Admin SDK credentials ุชู ุงูุญุตูู ุนูููุง
- [ ] Environment Variables ุชู ุฅุถุงูุชูุง ูู Railway
- [ ] Firebase ุชู ุชููุฆุชู ูู ุงูุชุทุจูู
- [ ] FCM tokens ูุชู ุฅุฑุณุงููุง ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู
- [ ] ุตูุงุญูุงุช ุงูุฅุดุนุงุฑุงุช ุชู ููุญูุง
- [ ] ุชู ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช

---

**ุจุนุฏ ุชุทุจูู ูุฐู ุงูุฎุทูุงุชุ ูุฌุจ ุฃู ุชุนูู ุงูุฅุดุนุงุฑุงุช ุจุดูู ุตุญูุญ! ๐**

